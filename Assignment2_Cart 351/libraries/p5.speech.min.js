/*! p5.speech.js v0.0.1 2015-06-12 */
/**
 *  p5.speech
 *  R. Luke DuBois (dubois@nyu.edu)
 *  ABILITY Lab / Brooklyn Experimental Media Center
 *  New York University
 *  The MIT License (MIT).
 *  
 *  https://github.com/IDMNYU/p5.js-speech
 *
 *  Web Speech API: https://dvcs.w3.org/hg/speech-api/raw-file/tip/speechapi.html
 *  Web Speech Recognition API: https://dvcs.w3.org/hg/speech-api/raw-file/tip/speechapi.html
 */
!function(t,e){"function"==typeof define&&define.amd?define("p5.speech",["p5"],function(t){e(t)}):"object"==typeof exports?e(require("../p5")):e(t.p5)}(this,function(t){t.Speech=function(t){this.synth=window.speechSynthesis,this.utterance=new SpeechSynthesisUtterance,this.isLoaded=0,this.interrupt=!1,this.onLoad,this.onStart,this.onPause,this.onResume,this.onEnd,this.voices=[],this.initvoice,void 0!==t&&(this.initvoice=t);var e=this;window.speechSynthesis.onvoiceschanged=function(){0==e.isLoaded&&(e.voices=window.speechSynthesis.getVoices(),e.isLoaded=1,console.log("p5.Speech: voices loaded!"),void 0!=e.initvoice&&(e.setVoice(e.initvoice),console.log("p5.Speech: initial voice: "+e.initvoice)),void 0!=e.onLoad&&e.onLoad(),e.utterance.onstart=function(t){void 0!=e.onStart&&e.onStart(t)},e.utterance.onpause=function(t){void 0!=e.onPause&&e.onPause(t)},e.utterance.onresume=function(t){void 0!=e.onResume&&e.onResume(t)},e.utterance.onend=function(t){void 0!=e.onEnd&&e.onEnd(t)})}},t.Speech.prototype.listVoices=function(){if(this.isLoaded)for(var t=0;t<this.voices.length;t++)console.log(this.voices[t].name);else console.log("p5.Speech: voices not loaded yet!")},t.Speech.prototype.setVoice=function(t){"string"==typeof t?this.utterance.voice=this.voices.filter(function(e){return e.name==t})[0]:"number"==typeof t&&(this.utterance.voice=this.voices[Math.min(Math.max(t,0),this.voices.length-1)])},t.Speech.prototype.setVolume=function(t){this.utterance.volume=Math.min(Math.max(t,0),1)},t.Speech.prototype.setRate=function(t){this.utterance.rate=Math.min(Math.max(t,.1),2)},t.Speech.prototype.setPitch=function(t){this.utterance.pitch=Math.min(Math.max(t,.01),2)},t.Speech.prototype.setLang=function(t){this.utterance.lang=t},t.Speech.prototype.speak=function(t){this.interrupt&&this.synth.cancel(),this.utterance.text=t,this.synth.speak(this.utterance)},t.Speech.prototype.pause=function(){this.synth.pause()},t.Speech.prototype.resume=function(){this.synth.resume()},t.Speech.prototype.stop=function(){this.synth.cancel()},t.Speech.prototype.cancel=function(){this.synth.cancel()},t.SpeechRec=function(t){"webkitSpeechRecognition"in window?this.rec=new webkitSpeechRecognition:(this.rec=new Object,console.log("p5.SpeechRec: webkitSpeechRecognition not supported in this browser.")),void 0!==t&&(this.rec.lang=t),this.onResult,this.onStart,this.onError,this.onEnd,this.continuous=!0,this.interimResults=!1,this.resultJSON,this.resultValue,this.resultString,this.resultConfidence;var e=this;this.rec.onresult=function(t){e.resultJSON=t,e.resultValue=t.returnValue,e.resultString=t.results[t.results.length-1][0].transcript.trim(),e.resultConfidence=t.results[t.results.length-1][0].confidence,void 0!=e.onResult&&e.onResult()},this.rec.onstart=function(t){void 0!=e.onStart&&e.onStart(t)},this.rec.onerror=function(t){void 0!=e.onError&&e.onError(t)},this.rec.onend=function(){void 0!=e.onEnd&&e.onEnd()}},t.SpeechRec.prototype.start=function(){"webkitSpeechRecognition"in window&&(this.rec.continuous=this.continuous,this.rec.interimResults=this.interimResults,this.rec.start())}});